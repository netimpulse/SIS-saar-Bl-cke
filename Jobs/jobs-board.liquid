{% comment %}
  Section: Job-Kacheln / Stellenangebote
{% endcomment %}

{{ 'jobs-board.css' | asset_url | stylesheet_tag }}

{%- style -%}
  /* ensure fonts are loaded */
  {{ section.settings.title_font | font_face }}
  {{ section.settings.subtitle_font | font_face }}
  {{ section.settings.jobtitle_font | font_face }}
  {{ section.settings.text_font | font_face }}
  {{ section.settings.location_font | font_face }}
  {{ section.settings.button_font | font_face }}
  {{ section.settings.badge_font | font_face }}
{%- endstyle -%}

<section id="jobs-{{ section.id }}" class="jobs-section"
  style="
    --jobs-section-bg: {{ section.settings.section_bg | default: '#f6f7fb' }};
    --jobs-pad-y: {{ section.settings.padding_y | default: 48 }}px;
    --jobs-gap: {{ section.settings.grid_gap | default: 24 }}px;
    --jobs-cols: {{ section.settings.columns | default: 2 }};
    --card-radius: {{ section.settings.card_radius | default: 16 }}px;
  "
>
  <div class="jobs-container">
    {%- if section.settings.heading != blank or section.settings.subheading != blank -%}
      <header class="jobs-header">
        {%- if section.settings.heading != blank -%}
          <h2
            style="
              margin:0 0 6px;
              font-family: {{ section.settings.title_font.family }}, {{ section.settings.title_font.fallback_families }};
              font-size: {{ section.settings.title_size | default: 38 }}px;
              color: {{ section.settings.title_color | default: '#0F172A' }};
              font-weight: {{ section.settings.title_weight | default: 700 }};
            "
          >
            {{ section.settings.heading }}
          </h2>
        {%- endif -%}

        {%- if section.settings.subheading != blank -%}
          <p
            style="
              margin:0;
              font-family: {{ section.settings.subtitle_font.family }}, {{ section.settings.subtitle_font.fallback_families }};
              font-size: {{ section.settings.subtitle_size | default: 16 }}px;
              color: {{ section.settings.subtitle_color | default: '#475569' }};
              font-weight: {{ section.settings.subtitle_weight | default: 400 }};
            "
          >
            {{ section.settings.subheading }}
          </p>
        {%- endif -%}
      </header>
    {%- endif -%}

    <div class="jobs-grid">
      {%- for block in section.blocks -%}
        {%- assign card_bg = block.settings.card_bg | default: section.settings.card_bg -%}
        {%- assign badge_bg = block.settings.badge_bg | default: section.settings.badge_bg -%}
        {%- assign badge_txt = block.settings.badge_text | default: section.settings.badge_text -%}

        {%- assign badge_label = block.settings.badge_label -%}
        {%- if badge_label == blank -%}
          {%- case block.settings.time -%}
            {%- when 'vollzeit' -%}{%- assign badge_label = 'Vollzeit' -%}
            {%- when 'teilzeit' -%}{%- assign badge_label = 'Teilzeit' -%}
            {%- when 'beides'   -%}{%- assign badge_label = 'Vollzeit / Teilzeit' -%}
            {%- when 'minijob'  -%}{%- assign badge_label = 'Minijob' -%}
            {%- else -%}{%- assign badge_label = '' -%}
          {%- endcase -%}
        {%- endif -%}

        <article class="job-card" {{ block.shopify_attributes }}
          style="--card-bg: {{ card_bg | default: '#ffffff' }};"
        >
          {%- if badge_label != blank -%}
            {% render 'job-badge',
              label: badge_label,
              bg_color: badge_bg,
              text_color: badge_txt,
              font: section.settings.badge_font,
              font_size: section.settings.badge_size,
              font_weight: section.settings.badge_weight
            %}
          {%- endif -%}

          {%- if block.settings.title != blank -%}
            <h3 class="job-title"
              style="
                font-family: {{ section.settings.jobtitle_font.family }}, {{ section.settings.jobtitle_font.fallback_families }};
                font-size: {{ section.settings.jobtitle_size | default: 22 }}px;
                color: {{ section.settings.jobtitle_color | default: '#0F172A' }};
                font-weight: {{ section.settings.jobtitle_weight | default: 700 }};
              "
            >
              {{ block.settings.title }}
            </h3>
          {%- endif -%}

          {%- if block.settings.desc != blank -%}
            <p class="job-desc"
              style="
                font-family: {{ section.settings.text_font.family }}, {{ section.settings.text_font.fallback_families }};
                font-size: {{ section.settings.text_size | default: 16 }}px;
                color: {{ section.settings.text_color | default: '#334155' }};
                font-weight: {{ section.settings.text_weight | default: 400 }};
              "
            >{{ block.settings.desc }}</p>
          {%- endif -%}

          {%- if block.settings.location != blank -%}
            <p class="job-meta"
              style="
                font-family: {{ section.settings.location_font.family }}, {{ section.settings.location_font.fallback_families }};
                font-size: {{ section.settings.location_size | default: 15 }}px;
                color: {{ section.settings.location_color | default: '#475569' }};
                font-weight: {{ section.settings.location_weight | default: 400 }};
              "
            >
              {{ block.settings.location }}
              <span class="jobs--sr-only">– Standort</span>
            </p>
          {%- endif -%}

          {%- if block.settings.btn_label != blank and block.settings.btn_url != blank -%}
            <a
              href="{{ block.settings.btn_url }}"
              class="job-button"
              target="{{ block.settings.btn_newtab | default: false | if: '_blank', else: '_self' }}"
              style="
                font-family: {{ section.settings.button_font.family }}, {{ section.settings.button_font.fallback_families }};
                font-size: {{ section.settings.button_size | default: 15 }}px;
                font-weight: {{ section.settings.button_weight | default: 600 }};
                color: {{ section.settings.button_text | default: '#ffffff' }};
                background: {{ section.settings.button_bg | default: '#111827' }};
                border-color: {{ section.settings.button_border | default: 'transparent' }};
              "
            >
              {{ block.settings.btn_label }}
            </a>
          {%- endif -%}
        </article>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Job-Kacheln",
  "settings": [
    { "type": "text", "id": "heading", "label": "Titel", "default": "Aktuelle Stellenausschreibungen" },
    { "type": "text", "id": "subheading", "label": "Untertitel", "default": "Finden Sie Ihre nächste berufliche Herausforderung bei uns" },

    { "type": "color", "id": "section_bg", "label": "Hintergrundfarbe der Section", "default": "#F6F7FB" },
    { "type": "color", "id": "card_bg", "label": "Standard Kachel-Hintergrund", "default": "#FFFFFF" },

    { "type": "range", "id": "padding_y", "label": "Innenabstand oben/unten (px)", "min": 0, "max": 120, "step": 2, "default": 48 },
    { "type": "range", "id": "grid_gap", "label": "Kachel-Abstand (px)", "min": 8, "max": 48, "step": 2, "default": 24 },
    { "type": "range", "id": "card_radius", "label": "Kachel-Abrundung (px)", "min": 0, "max": 32, "step": 1, "default": 16 },
    { "type": "select", "id": "columns", "label": "Spalten (ab Tablet)", "default": "2", "options": [
      { "value": "1", "label": "1" }, { "value": "2", "label": "2" }, { "value": "3", "label": "3" }
    ]},

    /* Typography – Section */
    { "type": "font_picker", "id": "title_font", "label": "Titel Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "title_size", "label": "Titel Größe (px)", "min": 10, "max": 80, "step": 1, "default": 44 },
    { "type": "color", "id": "title_color", "label": "Titel Farbe", "default": "#0F172A" },
    { "type": "select", "id": "title_weight", "label": "Titel Gewicht", "default": "700",
      "options": [{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"},{"value":"600","label":"Halbfett"},{"value":"700","label":"Fett"}] },

    { "type": "font_picker", "id": "subtitle_font", "label": "Untertitel Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "subtitle_size", "label": "Untertitel Größe (px)", "min": 10, "max": 40, "step": 1, "default": 16 },
    { "type": "color", "id": "subtitle_color", "label": "Untertitel Farbe", "default": "#475569" },
    { "type": "select", "id": "subtitle_weight", "label": "Untertitel Gewicht", "default": "400",
      "options": [{"value":"300","label":"Leicht"},{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"}] },

    /* Typography – Cards */
    { "type": "font_picker", "id": "jobtitle_font", "label": "Jobtitel Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "jobtitle_size", "label": "Jobtitel Größe (px)", "min": 12, "max": 40, "step": 1, "default": 22 },
    { "type": "color", "id": "jobtitle_color", "label": "Jobtitel Farbe", "default": "#0F172A" },
    { "type": "select", "id": "jobtitle_weight", "label": "Jobtitel Gewicht", "default": "700",
      "options": [{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"},{"value":"600","label":"Halbfett"},{"value":"700","label":"Fett"}] },

    { "type": "font_picker", "id": "text_font", "label": "Beschreibung Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "text_size", "label": "Beschreibung Größe (px)", "min": 10, "max": 30, "step": 1, "default": 16 },
    { "type": "color", "id": "text_color", "label": "Beschreibung Farbe", "default": "#334155" },
    { "type": "select", "id": "text_weight", "label": "Beschreibung Gewicht", "default": "400",
      "options": [{"value":"300","label":"Leicht"},{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"}] },

    { "type": "font_picker", "id": "location_font", "label": "Standort Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "location_size", "label": "Standort Größe (px)", "min": 10, "max": 30, "step": 1, "default": 15 },
    { "type": "color", "id": "location_color", "label": "Standort Farbe", "default": "#475569" },
    { "type": "select", "id": "location_weight", "label": "Standort Gewicht", "default": "400",
      "options": [{"value":"300","label":"Leicht"},{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"}] },

    /* Button */
    { "type": "font_picker", "id": "button_font", "label": "Button Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "button_size", "label": "Button Größe (px)", "min": 10, "max": 28, "step": 1, "default": 15 },
    { "type": "select", "id": "button_weight", "label": "Button Gewicht", "default": "600",
      "options": [{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"},{"value":"600","label":"Halbfett"},{"value":"700","label":"Fett"}] },
    { "type": "color", "id": "button_bg", "label": "Button Hintergrund", "default": "#111827" },
    { "type": "color", "id": "button_text", "label": "Button Textfarbe", "default": "#FFFFFF" },
    { "type": "color", "id": "button_border", "label": "Button Rahmenfarbe", "default": "transparent" },

    /* Badge Defaults */
    { "type": "font_picker", "id": "badge_font", "label": "Badge Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "badge_size", "label": "Badge Größe (px)", "min": 10, "max": 24, "step": 1, "default": 14 },
    { "type": "select", "id": "badge_weight", "label": "Badge Gewicht", "default": "600",
      "options": [{"value":"400","label":"Normal"},{"value":"500","label":"Mittel"},{"value":"600","label":"Halbfett"},{"value":"700","label":"Fett"}] },
    { "type": "color", "id": "badge_bg", "label": "Badge Hintergrund (Default)", "default": "#D1FADF" },
    { "type": "color", "id": "badge_text", "label": "Badge Textfarbe (Default)", "default": "#065F46" }
  ],
  "blocks": [
    {
      "type": "job",
      "name": "Job-Kachel",
      "settings": [
        { "type": "text", "id": "title", "label": "Jobtitel", "default": "Reinigungskraft (m/w/d)" },
        { "type": "textarea", "id": "desc", "label": "Kurzbeschreibung", "default": "Für die professionelle Gebäudereinigung in Bürogebäuden und öffentlichen Einrichtungen" },
        { "type": "text", "id": "location", "label": "Standort", "default": "Saarbrücken" },

        { "type": "select", "id": "time", "label": "Arbeitszeit", "default": "beides",
          "options": [
            { "value": "vollzeit", "label": "Vollzeit" },
            { "value": "teilzeit", "label": "Teilzeit" },
            { "value": "beides", "label": "Vollzeit / Teilzeit" },
            { "value": "minijob", "label": "Minijob" },
            { "value": "none", "label": "Kein Badge" }
          ]
        },
        { "type": "text", "id": "badge_label", "label": "Badge-Text (optional, überschreibt Auswahl)" },
        { "type": "color", "id": "badge_bg", "label": "Badge Hintergrund (optional)" },
        { "type": "color", "id": "badge_text", "label": "Badge Textfarbe (optional)" },

        { "type": "text", "id": "btn_label", "label": "Button-Text", "default": "Jetzt bewerben" },
        { "type": "url", "id": "btn_url", "label": "Button-Link" },
        { "type": "checkbox", "id": "btn_newtab", "label": "Link in neuem Tab öffnen", "default": false },

        { "type": "color", "id": "card_bg", "label": "Kachel-Hintergrund (optional)" }
      ]
    }
  ],
  "max_blocks": 24,
  "presets": [
    {
      "name": "Job-Kacheln (Karriere)",
      "blocks": [
        { "type": "job" },
        { "type": "job" },
        { "type": "job" },
        { "type": "job" }
      ]
    }
  ]
}
{% endschema %}
