{% comment %}
  Amenities Hotspots Section
  - Image mit klickbaren, pulsierenden Hotspots
  - Voll anpassbar im Editor
{% endcomment %}

{{ 'section-amenities-hotspots.css' | asset_url | stylesheet_tag }}
<script src="{{ 'amenities-hotspots.js' | asset_url }}" defer="defer"></script>

{% liquid
  assign s = section.settings
%}

{%- style -%}
  /* Lade die gewählten Webfonts */
  {{ s.heading_font | font_face }}
  {{ s.body_font | font_face }}
{%- endstyle -%}

<section
  id="AmenitiesHotspots-{{ section.id }}"
  class="amenities-hotspots"
  style="
    --ah-bg: {{ s.section_bg | default: '#ffffff' }};
    --ah-heading-color: {{ s.heading_color | default: '#111111' }};
    --ah-body-color: {{ s.body_color | default: '#444444' }};
    --ah-btn-bg: {{ s.button_bg | default: '#4CAF78' }};
    --ah-btn-color: {{ s.button_color | default: '#ffffff' }};
    --ah-heading-size: {{ s.heading_size | append: 'px' }};
    --ah-body-size: {{ s.body_size | append: 'px' }};
    --ah-heading-weight: {{ s.heading_weight }};
    --ah-body-weight: {{ s.body_weight }};
    --ah-gap: {{ s.content_gap | append: 'px' }};
    --ah-panel-maxw: {{ s.panel_maxw | append: 'px' }};
    --ah-pad-y: {{ s.pad_y | append: 'px' }};
    --ah-pad-x: {{ s.pad_x | append: 'px' }};
    --ah-dot-size: {{ s.dot_size | append: 'px' }};
    --ah-pulse-size: {{ s.pulse_size | append: 'px' }};
    --ah-heading-italic: {% if s.heading_italic %}italic{% else %}normal{% endif %};
    --ah-body-italic: {% if s.body_italic %}italic{% else %}normal{% endif %};
    --ah-heading-family: {{ s.heading_font.family | json }}, {{ s.heading_font.fallback_families }};
    --ah-body-family: {{ s.body_font.family | json }}, {{ s.body_font.fallback_families }};
  "
  data-section-id="{{ section.id }}"
  data-close-others="{{ s.close_others }}"
>
  <div class="ah-inner ah-side-{{ s.content_side }}">
    <div class="ah-content">
      {% if s.kicker != blank %}
        <p class="ah-kicker">{{ s.kicker }}</p>
      {% endif %}
      {% if s.heading != blank %}
        <h2 class="ah-heading">{{ s.heading }}</h2>
      {% endif %}
      {% if s.body != blank %}
        <div class="ah-body rte">{{ s.body }}</div>
      {% endif %}
      {% if s.btn_label != blank and s.btn_link != blank %}
        <a class="ah-btn" href="{{ s.btn_link }}" {% if s.btn_newtab %}target="_blank" rel="noopener noreferrer"{% endif %}>
          {{ s.btn_label }}
        </a>
      {% endif %}
    </div>

    <div class="ah-image-wrap">
      {% if s.image != blank %}
        {%- assign widths = '720,980,1200,1600,2000' -%}
        {%- assign sizes = '(min-width: 990px) 65vw, 100vw' -%}
        <img
          class="ah-image"
          srcset="{{ s.image | image_url: width: 720 }} 720w, {{ s.image | image_url: width: 980 }} 980w, {{ s.image | image_url: width: 1200 }} 1200w, {{ s.image | image_url: width: 1600 }} 1600w, {{ s.image | image_url: width: 2000 }} 2000w"
          sizes="{{ sizes }}"
          src="{{ s.image | image_url: width: 1600 }}"
          alt="{{ s.image.alt | escape }}"
          loading="lazy"
          width="{{ s.image.width }}"
          height="{{ s.image.height }}"
        >
      {% else %}
        {{ 'image' | placeholder_svg_tag: 'placeholder' }}
      {% endif %}

      <div class="ah-hotspots" aria-live="polite">
        {% for block in section.blocks %}
          {% render 'hotspot-badge', block: block, section_id: section.id %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Amenities Hotspots",
  "tag": "section",
  "class": "amenities-hotspots-section",
  "settings": [
    { "type": "image_picker", "id": "image", "label": "Bild" },

    { "type": "select", "id": "content_side", "label": "Textseite", "default": "left",
      "options": [
        {"value": "left", "label": "Links (wie Screenshot)"},
        {"value": "right", "label": "Rechts"}
      ]
    },

    { "type": "text", "id": "kicker", "label": "Kleiner Titel / Kicker", "default": "Special Amenities!" },
    { "type": "text", "id": "heading", "label": "Überschrift", "default": "Special Amenities!" },
    { "type": "richtext", "id": "body", "label": "Beschreibung", "default": "<p>Enter description text here. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>" },

    { "type": "font_picker", "id": "heading_font", "label": "Überschrift – Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "heading_size", "label": "Überschrift – Größe", "min": 14, "max": 80, "step": 1, "default": 44 },
    { "type": "select", "id": "heading_weight", "label": "Überschrift – Stärke", "default": "700",
      "options": [
        { "value": "300", "label": "Light 300" },
        { "value": "400", "label": "Normal 400" },
        { "value": "500", "label": "Medium 500" },
        { "value": "600", "label": "Semibold 600" },
        { "value": "700", "label": "Bold 700" },
        { "value": "800", "label": "Extra Bold 800" },
        { "value": "900", "label": "Black 900" }
      ]
    },
    { "type": "checkbox", "id": "heading_italic", "label": "Überschrift kursiv", "default": false },
    { "type": "color", "id": "heading_color", "label": "Überschrift – Farbe", "default": "#111111" },

    { "type": "font_picker", "id": "body_font", "label": "Text – Schriftart", "default": "poppins_n4" },
    { "type": "range", "id": "body_size", "label": "Text – Größe", "min": 12, "max": 28, "step": 1, "default": 16 },
    { "type": "select", "id": "body_weight", "label": "Text – Stärke", "default": "400",
      "options": [
        { "value": "300", "label": "Light 300" },
        { "value": "400", "label": "Normal 400" },
        { "value": "500", "label": "Medium 500" },
        { "value": "600", "label": "Semibold 600" },
        { "value": "700", "label": "Bold 700" }
      ]
    },
    { "type": "checkbox", "id": "body_italic", "label": "Text kursiv", "default": false },
    { "type": "color", "id": "body_color", "label": "Text – Farbe", "default": "#444444" },

    { "type": "text", "id": "btn_label", "label": "Button – Beschriftung", "default": "Call now" },
    { "type": "url",  "id": "btn_link", "label": "Button – Link" },
    { "type": "color", "id": "button_bg", "label": "Button – Hintergrund", "default": "#4CAF78" },
    { "type": "color", "id": "button_color", "label": "Button – Textfarbe", "default": "#ffffff" },
    { "type": "checkbox", "id": "btn_newtab", "label": "Link in neuem Tab öffnen", "default": false },

    { "type": "color", "id": "section_bg", "label": "Hintergrundfarbe der Section", "default": "#FFFFFF" },

    { "type": "range", "id": "content_gap", "label": "Abstand Text ↔ Bild", "min": 0, "max": 120, "step": 4, "default": 40 },
    { "type": "range", "id": "pad_y", "label": "Innenabstand oben/unten", "min": 0, "max": 120, "step": 4, "default": 40 },
    { "type": "range", "id": "pad_x", "label": "Innenabstand links/rechts", "min": 0, "max": 120, "step": 4, "default": 24 },

    { "type": "range", "id": "dot_size", "label": "Punkt – Größe", "min": 10, "max": 36, "step": 1, "default": 18 },
    { "type": "range", "id": "pulse_size", "label": "Puls – Stärke (px)", "min": 6, "max": 28, "step": 1, "default": 12 },

    { "type": "checkbox", "id": "close_others", "label": "Beim Öffnen andere Punkte schließen", "default": true },

    { "type": "range", "id": "panel_maxw", "label": "Max. Breite des Panels", "min": 180, "max": 520, "step": 10, "default": 360 }
  ],
  "blocks": [
    {
      "type": "hotspot",
      "name": "Hotspot",
      "settings": [
        { "type": "text", "id": "title", "label": "Titel", "default": "Smart Home Features" },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>Kurze Beschreibung zu diesem Punkt.</p>" },
        { "type": "range", "id": "pos_x", "label": "Position X (%)", "min": 0, "max": 100, "step": 1, "default": 35 },
        { "type": "range", "id": "pos_y", "label": "Position Y (%)", "min": 0, "max": 100, "step": 1, "default": 28 },

        { "type": "color", "id": "dot_color", "label": "Punkt – Farbe", "default": "#3AC47D" },
        { "type": "color", "id": "panel_bg", "label": "Panel – Hintergrund", "default": "#4CAF78" },
        { "type": "color", "id": "panel_text", "label": "Panel – Textfarbe", "default": "#ffffff" },

        { "type": "select", "id": "panel_position", "label": "Panel erscheint", "default": "top-left",
          "options": [
            { "value": "top-left", "label": "Oben links" },
            { "value": "top-right", "label": "Oben rechts" },
            { "value": "bottom-left", "label": "Unten links" },
            { "value": "bottom-right", "label": "Unten rechts" }
          ]
        },
        { "type": "checkbox", "id": "open_by_default", "label": "Diesen Punkt initial geöffnet zeigen", "default": false }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Amenities Hotspots",
      "category": "Bild",
      "blocks": [
        { "type": "hotspot" },
        { "type": "hotspot" },
        { "type": "hotspot" }
      ]
    }
  ]
}
{% endschema %}
